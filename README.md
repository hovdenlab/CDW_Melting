# Simulation of CDW Melting
Supplemental scripts for the manuscript "The Melting of Charge Density Waves in Low Dimensions". These scripts were used to simulate the melting of 2D CDWs. Simulated CDW melting dataset in Fig. 3a-f was executed in Matlab R2023a on the University of Michigan Great Lakes HPC Cluster for a total time of over 100 CPU-days.

We simulate the melting by mobile charge centers which hop according to Boltzmann statistics ($e^{-\frac{\Delta E}{kT}}$) through a Monte Carlo (MC) process. The interaction energy between charge centers is calculated using a shifted Lennard Jones potential truncated at 100 angstroms. This effectively treats high-temperature CDWs as a phenomenological charge crystal. CDW amplitude collapse is modeled with the removal of charge centers at topological defect sites. The simulation is of a grand canonical ensemble (varying particle count, constant volume and temperature). Every 150 iterations, we remove a charge center with the lowest $\Psi_6$ order parameter until we reach a minimum energy configuration.

In order to accomodate large simulated CDW systems, we adopt a parallelized approach to the computationally-expensive charge fluctuation step. 
1. We initially melt the CDW with a Monte Carlo simulation of the NPT ensemble (constant particle count, temperature, and pressure) using the Matlab script `melt_classical.m`.
   - System parameters are directly tuned in the file. `mul` sets the initial partical count. `numIter` sets the number of MC steps per temperature slice. `temp_vals` set the desired temperatures to be simulated. The Lennard-Jones potential is defined by `rmin`, `r_c`, and `ep` which dicatate the energy minimum position, cutoff distance, and well depth, respectively.
   - The results are stored in a .mat file. `posSLs` is a (*n* x *2* x *# of temps*)-matrix which stores the charge center xy-locations across temperatures. `posLT_PLD` is a (*m* x *2* x *# of temps*)-matrix of the xy-locations of Tantalum atoms in the atomic lattice with periodic lattice distortions. `xCutoffSLs` or `yCutoffSLs` are the extents of the charge crystal across temperatures.

3. Subsquently at each temperature slice, we identify and remove topological defect sites until a constant volume, minimum energy configuration is obtained using the Matlab script `relax_temp_slice.m`. This step can be executed in parallel across all temperatures.
   - System parameters are directly tuned in the file.`kill_iters` sets the maximum number of charge centers that can be removed. `numIter` sets the number of MC steps between charge removal steps. `t_ix` selects the index of the temperature to be simulated at.
   - The results of each temperature slice are stored in a .mat file. `posSL` stores the constant volume, minimum energy configuration. `num_sites_removed` stores the number of charge centers removed. `xCutoffSLs` or `yCutoffSLs` can be used to check if the system has returned to a constant volume state.
